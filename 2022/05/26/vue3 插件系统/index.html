<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Hexo
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.2.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            vue3 插件系统
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h2 id="vue3-插件系统"><a href="#vue3-插件系统" class="headerlink" title="vue3 插件系统"></a>vue3 插件系统</h2><p>一段代码给 vue 应用实例添加全局功能</p>
<p>它的格式是 一个 <strong>object</strong> ，暴露出一个 <strong>install</strong>() 方法，或者是一个 <strong>function</strong></p>
<p>它没有严格的限制，一般有以下几种功能</p>
<ul>
<li>添加全局方法或属性</li>
<li>添加全局资源： 指令，过滤器等</li>
<li>通过全局呼入一些来添加一些组件选项</li>
<li>通过config.globalProperties 来添加app 实例方法</li>
</ul>
<h2 id="编写一个-vue3-插件"><a href="#编写一个-vue3-插件" class="headerlink" title="编写一个 vue3 插件"></a><strong>编写一个 vue3 插件</strong></h2><ul>
<li>首先这个插件拥有属于自己的模板也就是我们的 .vue 文件</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;HelloWrold&quot;</span>&gt;</span> HelloWrold <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"> <span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"> <span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&quot;HelloWrold&quot;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">   ...</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"> &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>然后我们需要暴露一个 install 方法出去，在 install 方法里面处理所有的逻辑，这样 vue 就可以 use 这个插件了</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">HelloWrold</span> <span class="keyword">from</span> <span class="string">&#x27;HelloWrold.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">有了模板之后，</span></span><br><span class="line"><span class="comment">- 我们就需要创建应用 app</span></span><br><span class="line"><span class="comment">- 创建一个元素 div 追加于 body 后面</span></span><br><span class="line"><span class="comment">- 然后使用应用 app 来挂载这个 div 元素</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="keyword">const</span> createComp = <span class="keyword">function</span>(<span class="params">comp, prop</span>) &#123;</span><br><span class="line"> <span class="comment">// 创建组件</span></span><br><span class="line"> <span class="keyword">const</span> app = <span class="title function_">createApp</span>(comp, &#123;</span><br><span class="line">  ...prop</span><br><span class="line"> &#125;)</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// 创建一个元素</span></span><br><span class="line"> <span class="keyword">const</span> divEle = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(divEle)</span><br><span class="line"> <span class="comment">// 将组件挂载到创建的 div 中</span></span><br><span class="line"> app.<span class="title function_">mount</span>(divEle)</span><br><span class="line"> <span class="comment">// 返回创建的元素</span></span><br><span class="line"> <span class="keyword">return</span> divEle</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"> <span class="title function_">install</span>(<span class="params">app, options</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建全局指令</span></span><br><span class="line">  app.<span class="title function_">directive</span>(<span class="string">&#x27;focus&#x27;</span>, &#123;</span><br><span class="line">      mounted (el, binding, vnode, oldVnode) &#123;</span><br><span class="line">         <span class="comment">// 动态挂载组件</span></span><br><span class="line">     <span class="title function_">createComp</span>(<span class="title class_">HelloWrold</span>, &#123;...&#125;)</span><br><span class="line">     <span class="comment">// 聚焦元素</span></span><br><span class="line">     el.<span class="title function_">focus</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      ...</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加全局实例方法，通过把它们添加到 config.globalProperties 上实现。</span></span><br><span class="line">  app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$echo</span> = <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">   conosle.<span class="title function_">log</span>(str)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 全局注册组件 (不需要调用组件内注册 ，直接使用 )</span></span><br><span class="line">  app.<span class="title function_">component</span>(<span class="string">&#x27;hello-wrold&#x27;</span>, <span class="title class_">HelloWrold</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 使用 inject 为插件的用户提供功能或 attribute</span></span><br><span class="line">  <span class="comment">// 插件用户现在可以将 inject[test] 注入到他们的组件并访问该对象</span></span><br><span class="line">  app.<span class="title function_">provide</span>(<span class="string">&#x27;test&#x27;</span>, &#123; <span class="attr">msg</span>: <span class="string">&#x27;from plugin&#x27;</span>&#125;) </span><br><span class="line">  </span><br><span class="line">  <span class="comment">//使用 mixin</span></span><br><span class="line">  app.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">      <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello world&#x27;</span>) <span class="comment">// 每个组件都会执行</span></span><br><span class="line">      &#125;</span><br><span class="line">      ...</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="vue3-的插件的使用"><a href="#vue3-的插件的使用" class="headerlink" title="vue3 的插件的使用"></a>vue3 的插件的使用</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> myPlugin <span class="keyword">from</span> <span class="string">&#x27;myPlugin.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line">app.<span class="title function_">use</span>(myPlugin)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--调用全局组件--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">hello-wrold</span>&gt;</span><span class="tag">&lt;/<span class="name">hello-wrold</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--调用全局指令--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-focus</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; defineComponent, onMounted, inject, getCurrentInstance &#125; <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&quot;App&quot;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">   <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 调用全局 provide 的数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">inject</span>(<span class="string">&#x27;test&#x27;</span>))</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 调用全局方法</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">getCurrentInstance</span>()?.<span class="property">appContext</span>.<span class="property">config</span>.<span class="property">globalProperties</span>.$echo(<span class="string">&#x27;hellow&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">   &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="组件库入口文件的设计"><a href="#组件库入口文件的设计" class="headerlink" title="组件库入口文件的设计"></a>组件库入口文件的设计</h2><h3 id="单个组件导入并且作为插件使用"><a href="#单个组件导入并且作为插件使用" class="headerlink" title="单个组件导入并且作为插件使用"></a>单个组件导入并且作为插件使用</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LText</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;myComponets&#x27;</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">LText</span>)</span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line">app.<span class="title function_">component</span>(<span class="title class_">LText</span>.<span class="property">name</span>, <span class="title class_">LText</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现思路</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 每个组件新建一个文件夹，并且创建一个单独的 index.js 文件</span></span><br><span class="line"><span class="comment"> 每个组价设计成一个插件（一个 object 拥有一个 install 方法）	</span></span><br><span class="line"><span class="comment"> 在全局入口导入</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// src/components/LText/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">App</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LText</span> <span class="keyword">from</span> <span class="string">&#x27;./LText.vue&#x27;</span></span><br><span class="line"><span class="title class_">LText</span>.<span class="property">install</span> = <span class="function">(<span class="params">app</span>) =&gt;</span> &#123;</span><br><span class="line"> app.<span class="title function_">component</span>(<span class="title class_">LText</span>.<span class="property">name</span>, <span class="title class_">LText</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">LText</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="所有组件一次性全部导入并且作为插件使用"><a href="#所有组件一次性全部导入并且作为插件使用" class="headerlink" title="所有组件一次性全部导入并且作为插件使用"></a>所有组件一次性全部导入并且作为插件使用</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现思路</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 建立一个入口文件 index.js</span></span><br><span class="line"><span class="comment"> 将所有组件导入，作为一个数组， 常见一个 install 函数，循环调用 app.component</span></span><br><span class="line"><span class="comment"> 默认导出一个 插件 （ 这个install 函数 ）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">App</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LText</span> <span class="keyword">from</span> <span class="string">&#x27;./components/LText.vue&#x27;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> components = [ </span><br><span class="line"> <span class="title class_">LText</span></span><br><span class="line"> ...</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">install</span> = (<span class="params">app</span>) =&gt; &#123;</span><br><span class="line"> components.<span class="title function_">forEach</span>(<span class="function"><span class="params">componet</span> =&gt;</span> &#123;</span><br><span class="line">  app.<span class="title function_">component</span>(componet.<span class="property">name</span>, componet)</span><br><span class="line"> &#125;)</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line"> <span class="title class_">LText</span>,</span><br><span class="line"> ...</span><br><span class="line"> install</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; </span><br><span class="line"> install</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件库调用</span></span><br><span class="line"><span class="keyword">import</span> myComponents <span class="keyword">from</span> <span class="string">&#x27;myComponets&#x27;</span></span><br><span class="line">app.<span class="title function_">use</span>(myComponents)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="组件单元测试"><a href="#组件单元测试" class="headerlink" title="组件单元测试"></a>组件单元测试</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;setCount&quot;</span>&gt;</span>&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"> <span class="keyword">import</span> &#123; defineComponent, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"> <span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&#x27;HelloWorld&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">   <span class="attr">msg</span>: <span class="title class_">String</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">emits</span>: [<span class="string">&#x27;send&#x27;</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">setup</span>(<span class="params">props, context</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">const</span> <span class="title function_">setCount</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    count.<span class="property">value</span>++</span></span><br><span class="line"><span class="language-javascript">   &#125;</span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    count,</span></span><br><span class="line"><span class="language-javascript">    setCount</span></span><br><span class="line"><span class="language-javascript">   &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"> &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加单元测试依赖 (在项目根目录中，添加@vue/test-utils and jest)</span></span><br><span class="line"> vue add unit-jest</span><br><span class="line"></span><br><span class="line"><span class="comment">// jest.config.js</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 比较重要的配置，也是我们比较多用来解决问题的配置：</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">  transform : 转化方式，匹配的文件要经过转译才能被识别，否则会报错。</span></span><br><span class="line"><span class="comment"> transformIgnorePatterns : 转化忽略配置</span></span><br><span class="line"><span class="comment"> moduleNameMapper : 模块别名，如果有用到都要填写进去</span></span><br><span class="line"><span class="comment"> moduleFileExtensions ： 测试的文件类型，这里默认的配置基本涵盖了文件类型，所以这里一般不需要改</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">preset</span>: <span class="string">&#x27;@vue/cli-plugin-unit-jest/presets/typescript-and-babel&#x27;</span>,</span><br><span class="line"> <span class="attr">transform</span>: &#123; <span class="comment">// 转化方式</span></span><br><span class="line">     <span class="comment">// process *.vue files with vue-jest</span></span><br><span class="line">     <span class="string">&#x27;^.+\\.vue$&#x27;</span>: <span class="built_in">require</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;vue-jest&#x27;</span>),</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 常用API [文档](https://test-utils.vuejs.org/guide/)</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> mount : 一股脑全都渲染</span></span><br><span class="line"><span class="comment"> shallowMount : 只渲染组件本身，外来的子组件都不渲染 （更快，适合单元测试）</span></span><br><span class="line"><span class="comment"> get : 找不到报错， 程序会中断</span></span><br><span class="line"><span class="comment"> getAll </span></span><br><span class="line"><span class="comment"> find : 找不到返回 null ，可用来判断元素是否存在</span></span><br><span class="line"><span class="comment"> findAll</span></span><br><span class="line"><span class="comment"> findComponent: 查找组件 没有找到 返回null</span></span><br><span class="line"><span class="comment"> getComponent: 查找组件 找不到报错，程序会中断</span></span><br><span class="line"><span class="comment"> trigger: 触发事件 </span></span><br><span class="line"><span class="comment"> setValue : 更新表单</span></span><br><span class="line"><span class="comment"> wrapper.emitted(): 验证事件是否发送</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 钩子函数：</span></span><br><span class="line"><span class="comment">  一次性完成的测试准备</span></span><br><span class="line"><span class="comment">   beforeAll</span></span><br><span class="line"><span class="comment">   afterAll</span></span><br><span class="line"><span class="comment">  每个测试测试准备</span></span><br><span class="line"><span class="comment">   beforeEach</span></span><br><span class="line"><span class="comment">   afterEach</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment"> 小tips：</span></span><br><span class="line"><span class="comment">  it.only // 这运行这一个测试用例</span></span><br><span class="line"><span class="comment">  it.skip // 跳过该测试用例</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试代码</span></span><br><span class="line"><span class="keyword">import</span> &#123; shallowMount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LText</span> <span class="keyword">from</span> <span class="string">&#x27;../../src/components/LText&#x27;</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;LText.vue&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="title function_">it</span>(<span class="string">&#x27;default LText render&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> msg = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> props = &#123; <span class="attr">text</span>: msg &#125;</span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">shallowMount</span>(<span class="title class_">LText</span>, &#123; props &#125;)</span><br><span class="line"></span><br><span class="line"> <span class="comment">// should have the text</span></span><br><span class="line"> <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toBe</span>(msg)</span><br><span class="line"> <span class="comment">// should be default div tag</span></span><br><span class="line"> <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">tagName</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;DIV&#x27;</span>)</span><br><span class="line"> <span class="comment">// should have certian css attr</span></span><br><span class="line"> <span class="keyword">const</span> style = wrapper.<span class="title function_">attributes</span>().<span class="property">style</span></span><br><span class="line"> <span class="title function_">expect</span>(style.<span class="title function_">includes</span>(<span class="string">&#x27;font-size&#x27;</span>)).<span class="title function_">toBeTruthy</span>()</span><br><span class="line"> &#125;)</span><br><span class="line"> <span class="comment">// 异步测试</span></span><br><span class="line"> <span class="title function_">it</span>(<span class="string">&#x27;shouldupdate the count when clicking the button&#x27;</span>, <span class="title function_">async</span>() =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> msg = <span class="string">&#x27;new msg&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">shalloMount</span>(<span class="title class_">HellowWrold</span>, &#123;</span><br><span class="line">   <span class="attr">props</span>: &#123; msg &#125;</span><br><span class="line">  &#125;)		</span><br><span class="line">  <span class="keyword">await</span> wrapper.<span class="title function_">get</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>)</span><br><span class="line">  <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="组件库打包"><a href="#组件库打包" class="headerlink" title="组件库打包"></a>组件库打包</h2><h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123; </span><br><span class="line"> <span class="string">&quot;name&quot;</span>: <span class="string">&quot;my-components&quot;</span>,</span><br><span class="line"> <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>, <span class="comment">//  &lt;主版本号&gt;.&lt;次版本号&gt;.&lt;修订号&gt;</span></span><br><span class="line"> <span class="string">&quot;main&quot;</span>: <span class="string">&#x27;dist/my-components/umd.js&#x27;</span>, <span class="comment">// 入口文件</span></span><br><span class="line"> <span class="string">&quot;module&quot;</span>: <span class="string">&quot;dist/my-components.esm.js&quot;</span>, <span class="comment">// node 入口文件</span></span><br><span class="line">  <span class="comment">// &quot;types&quot;: &quot;dist/index.d.ts&quot;, // ts 入口文件</span></span><br><span class="line"> <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;vue-cli-service lint&quot;</span>,</span><br><span class="line">  <span class="string">&quot;test&quot;</span>: <span class="string">&quot;vue-cli-service test:unit&quot;</span>,</span><br><span class="line">  <span class="string">&quot;build&quot;</span>: <span class="string">&quot;npm run clean &amp;&amp; npm run build:esm&quot;</span>,</span><br><span class="line">  <span class="string">&quot;build:esm&quot;</span>: <span class="string">&quot;rollup --config build/rollup.config.js&quot;</span>,</span><br><span class="line">  <span class="string">&quot;clean&quot;</span>: <span class="string">&quot;rimraf ./dist&quot;</span></span><br><span class="line">  <span class="string">&quot;prepublishOnly&quot;</span>: <span class="string">&quot;npm run lint &amp;&amp; npm run test &amp;&amp; npm run build&quot;</span> </span><br><span class="line"> &#125;,</span><br><span class="line"> <span class="string">&quot;dependencies&quot;</span>: &#123;&#125;,</span><br><span class="line"> <span class="string">&quot;peerDependencies&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;vue&quot;</span>: <span class="string">&quot;^3.0.0&quot;</span> <span class="comment">// 告知该组件库依赖 vue3</span></span><br><span class="line"> &#125;,</span><br><span class="line"> <span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;rimraf&quot;</span>: <span class="string">&quot;3.0.2&quot;</span>,</span><br><span class="line">  <span class="string">&quot;vue&quot;</span>: <span class="string">&quot;^3.0.0&quot;</span>, <span class="comment">// 开发环境使用</span></span><br><span class="line">  <span class="string">&quot;rollup&quot;</span>: <span class="string">&quot;^2.38.5&quot;</span>,</span><br><span class="line">  <span class="string">&quot;rollup-plugin-css-only&quot;</span>: <span class="string">&quot;^3.1.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;rollup-plugin-vue&quot;</span>: <span class="string">&quot;^6.0.0&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// npm 依赖的分类</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> dependencies</span></span><br><span class="line"><span class="comment">  运行项目业务逻辑需要依赖的第三方库</span></span><br><span class="line"><span class="comment">  npm install &#x27;模块名称&#x27;的时候都会被机械，下载</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> devDependencies</span></span><br><span class="line"><span class="comment">  开发模式工作流下依赖的第三方库</span></span><br><span class="line"><span class="comment">  单元测试，语法转换，lint工具，程序构建，本地开发等等</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> peerDependencies</span></span><br><span class="line"><span class="comment">  需要核心依赖库，不能脱离依赖库单独使用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Rollup打包"><a href="#Rollup打包" class="headerlink" title="Rollup打包"></a>Rollup打包</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// build/rollup.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; terser &#125; <span class="keyword">from</span> <span class="string">&#x27;rollup-blugin-terser&#x27;</span> <span class="comment">// 压缩混淆代码</span></span><br><span class="line"><span class="keyword">import</span> &#123; nodeReslove &#125; <span class="string">&#x27;@rollup/plugin-node-resove&#x27;</span> <span class="comment">// 帮助 Rollup 查找外部模块</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;roolup-plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> css <span class="keyword">from</span> <span class="string">&#x27;roolup-plugin-css-only&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; name &#125; <span class="keyword">from</span> <span class="string">&#x27;../package.json&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">file</span> = type =&gt; <span class="string">`dist/<span class="subst">$&#123;name&#125;</span>.<span class="subst">$&#123;type&#125;</span>.js`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"> <span class="attr">input</span>: <span class="string">&#x27;src/App.vue&#x27;</span>,</span><br><span class="line"> <span class="attr">output</span>: &#123;</span><br><span class="line">  name, </span><br><span class="line">  <span class="attr">file</span>: <span class="title function_">file</span>(<span class="string">&#x27;esm&#x27;</span>)</span><br><span class="line">  <span class="attr">format</span>: <span class="string">&#x27;es&#x27;</span></span><br><span class="line">  <span class="attr">globals</span>: &#123; <span class="comment">// 全局变量的名字</span></span><br><span class="line">   <span class="string">&#x27;vue&#x27;</span>: <span class="string">&#x27;Vue&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"> &#125;,</span><br><span class="line"> <span class="attr">plugins</span>: [</span><br><span class="line">  <span class="title function_">terser</span>(),</span><br><span class="line">  <span class="title function_">nodeReslove</span>(),</span><br><span class="line">  <span class="title function_">vue</span>(),</span><br><span class="line">  <span class="title function_">css</span>(&#123;<span class="attr">output</span>: <span class="string">&#x27;bundle.css&#x27;</span>&#125;)</span><br><span class="line"> ],</span><br><span class="line"> <span class="attr">external</span>: [<span class="string">&#x27;vue&#x27;</span>]<span class="comment">// 哪些是外部引用，打包时将其省略掉</span></span><br><span class="line"> <span class="comment">// external: (id) =&gt; &#123; return /^vue/.test(id) &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* @rollup/plugin-node-resolve 的作用</span></span><br><span class="line"><span class="comment"> 比较：</span></span><br><span class="line"><span class="comment">  不配置 @rollup/plugin-node-resolve 插件引入方式</span></span><br><span class="line"><span class="comment">   export foo from ‘./foo/index.js‘</span></span><br><span class="line"><span class="comment">   import bar from ‘./bar/index.js‘</span></span><br><span class="line"><span class="comment">  配置了 @rollup/plugin-node-resolve 插件引入方式</span></span><br><span class="line"><span class="comment">   export foo from ‘./foo‘</span></span><br><span class="line"><span class="comment">   import bar from ‘./bar‘</span></span><br><span class="line"><span class="comment">  可以看出不配置的话引入路径必须是完整的。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="组件库通过-npm-包发布"><a href="#组件库通过-npm-包发布" class="headerlink" title="组件库通过 npm 包发布"></a>组件库通过 npm 包发布</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检测是否登录 </span></span><br><span class="line"> <span class="string">npm</span> <span class="string">whoami</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># npm 登录</span></span><br><span class="line"> <span class="string">npm</span> <span class="string">login</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看配置信息是否使用了镜像代理 （registry = &quot;http://registry.npm.taobao.org&quot;）</span></span><br><span class="line"><span class="comment"># 有代理镜像 无法登录</span></span><br><span class="line"> <span class="string">npm</span> <span class="string">config</span> <span class="string">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发布前填写 package.json 信息</span></span><br><span class="line"> <span class="comment"># &lt;主版本号&gt;.&lt;次版本号&gt;.&lt;修订号&gt;</span></span><br><span class="line"> <span class="comment"># 主版本号： 当你做了不兼容的 API 修改</span></span><br><span class="line"> <span class="comment"># 此版本号： 当你做了向下加绒的功能性新增</span></span><br><span class="line"> <span class="comment"># 修订号： 当前做了向下兼容的问题修正</span></span><br><span class="line">  <span class="attr">&quot;version&quot;:</span> <span class="string">&quot;1.0.0&quot;</span><span class="string">,</span> </span><br><span class="line"> <span class="comment"># 相关信息</span></span><br><span class="line">   <span class="attr">&quot;keyworks&quot;:</span> [ <span class="string">&quot;Component&quot;</span>, <span class="string">&quot;Vue3&quot;</span>]</span><br><span class="line"> <span class="comment"># 默认忽略掉 gitingore 中的内容</span></span><br><span class="line"> <span class="comment"># 指示 npm publish 的时候需要上传的内容</span></span><br><span class="line"> <span class="comment"># package.json/ README.md/ CHANGLOG.md/ LiCENSE 都包含其中</span></span><br><span class="line">  <span class="attr">&quot;file&quot;:</span> [ <span class="string">&quot;dist&quot;</span> ]</span><br><span class="line"> <span class="comment"># scripts 钩子</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;:</span> &#123;</span><br><span class="line">   <span class="attr">&quot;precompress&quot;:</span> <span class="string">&quot;&quot;</span>, <span class="comment"># compress 之前执行</span></span><br><span class="line">   <span class="attr">&quot;compress&quot;:</span> <span class="string">&quot;&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;postcompress&quot;:</span> <span class="string">&quot;&quot;</span> <span class="comment"># compress 之后执行</span></span><br><span class="line">   <span class="attr">&quot;prepublishOnly&quot;:</span> <span class="string">&quot;&quot;</span> <span class="comment"># 在发布之前运行</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment"># npm 发布</span></span><br><span class="line"> <span class="string">npm</span> <span class="string">publish</span></span><br></pre></td></tr></table></figure>

    </div>

    
</div>
    <div class="footer" id="footer">
    <p style="display: none;">Copyright © 2020 <a class="flink" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>-<a class="flink" target="_blank" rel="noopener" href="https://github.com/sanjinhub/hexo-theme-geek">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="CmCti21ooOOIzFOhEyFkFvR0-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="FqiyUqbg7McKN2eG0MCewupf">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>